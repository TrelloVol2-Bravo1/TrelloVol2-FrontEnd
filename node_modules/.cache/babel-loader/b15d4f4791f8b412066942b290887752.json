{"ast":null,"code":"var _jsxFileName = \"/home/przemek/Documents/TrelloVol2-FrontEnd/src/components/table.component.tsx\";\nimport React from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport UserService from \"../services/user.service\";\nimport Card from \"react-bootstrap/Card\";\nimport styles from \"./tables.module.css\";\nimport Button from \"react-bootstrap/Button\";\nimport ApiService from \"../services/api.service\";\nimport { ListModel } from \"../models/list.model\";\nimport { CardModel } from \"../models/card.model\";\nimport Form from \"react-bootstrap/Form\";\nexport default class TablesComponent extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      redirect: false,\n      redirectUrl: '',\n      refresh: false,\n      creationView: false,\n      newListName: '',\n      objectToCreate: '',\n      newCardName: '',\n      description: '',\n      list_id: 0\n    };\n    this.lists = [];\n    this.cards = [];\n\n    this.render = () => {\n      UserService.subject.subscribe(() => {\n        this.setState({\n          redirect: true,\n          redirectUrl: '/login'\n        });\n      });\n      return /*#__PURE__*/React.createElement(React.Fragment, null, this.renderRedirect(), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: () => this.handleBackToBoards(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }\n      }, \"Back to boards\"), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: () => this.toggleCreationView(true, 'list', -1),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }\n      }, \"New list\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.creationForm,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 17\n        }\n      }, this.createListCreationView()), /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.tables,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 17\n        }\n      }, this.createLists())));\n    };\n  }\n\n  refresh() {\n    this.setState({\n      refresh: false\n    });\n    this.setState({\n      refresh: true\n    });\n  }\n\n  handleBackToBoards() {\n    this.setState({\n      redirect: true,\n      redirectUrl: 'tables'\n    });\n  }\n\n  async componentDidMount() {\n    this.lists = await ApiService.GetLists(+window.location.pathname.split('/')[2]);\n    const buffer = [];\n\n    for (const list of this.lists) {\n      let cards = await ApiService.GetCards(list.getListID());\n\n      for (const card of cards) {\n        buffer.push(card);\n      }\n    }\n\n    this.cards = buffer;\n    this.refresh();\n  }\n\n  createLists() {\n    let lists = [];\n\n    if (this.state.refresh) {\n      let view = [];\n      this.lists.forEach(list => {\n        view.push( /*#__PURE__*/React.createElement(Card, {\n          className: styles.card,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 27\n          }\n        }, /*#__PURE__*/React.createElement(Card.Body, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(Card.Title, {\n          className: styles.listTitle,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 62,\n            columnNumber: 25\n          }\n        }, list.getListName(), /*#__PURE__*/React.createElement(Button, {\n          className: styles.cardButton,\n          onClick: () => {\n            this.deleteList(list);\n          },\n          variant: \"danger\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 29\n          }\n        }, \"Delete\")), this.createCards(list.getListID()), /*#__PURE__*/React.createElement(\"button\", {\n          onClick: () => {\n            this.toggleCreationView(true, 'card', list.getListID());\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 25\n          }\n        }, \"Create new card\"))));\n      });\n      lists.push(view);\n    }\n\n    return lists;\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  async createList(name) {\n    const response = await ApiService.CreateList(name, +window.location.pathname.split('/')[2]);\n    const list = new ListModel(response.list_id, response.list_name);\n    this.lists.push(list);\n    this.refresh();\n  }\n\n  async createCard(name, description, list_id) {\n    const response = await ApiService.CreateCard(name, description, list_id);\n    const card = new CardModel(response.card_id, response.list_id, response.card_name, response.card_description);\n    this.cards.push(card);\n    this.refresh();\n  }\n\n  createListCreationView() {\n    if (this.state.creationView && this.state.objectToCreate === 'list') {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.createNewButtonDiv,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Form.Group, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(Form.Control, {\n        name: 'newListName',\n        value: this.state.newListName,\n        onChange: this.handleChange.bind(this),\n        type: \"text\",\n        placeholder: \"New list name\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 29\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.createNewButtonDiv,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        onClick: () => this.createList(this.state.newListName),\n        variant: \"success\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 25\n        }\n      }, \"Create\"), /*#__PURE__*/React.createElement(Button, {\n        onClick: () => this.toggleCreationView(false, '', -1),\n        variant: \"danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 25\n        }\n      }, \"Hide\")));\n    } else if (this.state.creationView && this.state.objectToCreate === 'card') {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.createNewButtonDiv,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Form.Group, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(Form.Control, {\n        name: 'newCardName',\n        value: this.state.newCardName,\n        onChange: this.handleChange.bind(this),\n        type: \"text\",\n        placeholder: \"New card name\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(Form.Control, {\n        name: 'description',\n        value: this.state.description,\n        onChange: this.handleChange.bind(this),\n        type: \"text\",\n        placeholder: \"Description\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 29\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.createNewButtonDiv,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        onClick: () => this.createCard(this.state.newCardName, this.state.description, this.state.list_id),\n        variant: \"success\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 25\n        }\n      }, \"Create\"), /*#__PURE__*/React.createElement(Button, {\n        onClick: () => this.toggleCreationView(false, '', -1),\n        variant: \"danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 25\n        }\n      }, \"Hide\")));\n    }\n  }\n\n  toggleCreationView(status, object, list_id) {\n    this.setState({\n      creationView: status,\n      objectToCreate: object,\n      list_id: list_id\n    });\n  }\n\n  renderRedirect() {\n    if (this.state.redirect) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: '/' + this.state.redirectUrl,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 20\n        }\n      });\n    }\n  }\n\n  createCards(list_id) {\n    let cards = [];\n\n    if (this.state.refresh) {\n      let view = [];\n      this.cards.forEach(card => {\n        if (card.getCardListID() === list_id) {\n          view.push( /*#__PURE__*/React.createElement(Card, {\n            className: styles.cardObject,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 31\n            }\n          }, /*#__PURE__*/React.createElement(Card.Body, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 25\n            }\n          }, /*#__PURE__*/React.createElement(Card.Title, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 29\n            }\n          }, card.getCardName()), /*#__PURE__*/React.createElement(\"p\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 29\n            }\n          }, card.getCardDescription()), /*#__PURE__*/React.createElement(\"div\", {\n            className: styles.btnGroup,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 29\n            }\n          }, /*#__PURE__*/React.createElement(Button, {\n            className: styles.cardButton,\n            onClick: () => {\n              this.deleteCard(card);\n            },\n            variant: \"danger\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 33\n            }\n          }, \"Delete\")))));\n        }\n      });\n      cards.push(view);\n    }\n\n    return cards;\n  }\n\n  deleteCard(card) {\n    const index = this.cards.indexOf(card);\n\n    if (index !== -1) {\n      ApiService.DeleteCard(card).then(() => {\n        this.cards.splice(index, 1);\n        this.refresh();\n      });\n    }\n  }\n\n  deleteList(list) {\n    const index = this.lists.indexOf(list);\n\n    if (index !== -1) {\n      ApiService.DeleteList(list).then(() => {\n        this.lists.splice(index, 1);\n        this.refresh();\n      });\n    }\n  }\n\n}","map":{"version":3,"sources":["/home/przemek/Documents/TrelloVol2-FrontEnd/src/components/table.component.tsx"],"names":["React","Redirect","UserService","Card","styles","Button","ApiService","ListModel","CardModel","Form","TablesComponent","Component","state","redirect","redirectUrl","refresh","creationView","newListName","objectToCreate","newCardName","description","list_id","lists","cards","render","subject","subscribe","setState","renderRedirect","handleBackToBoards","toggleCreationView","container","creationForm","createListCreationView","tables","createLists","componentDidMount","GetLists","window","location","pathname","split","buffer","list","GetCards","getListID","card","push","view","forEach","listTitle","getListName","cardButton","deleteList","createCards","handleChange","event","target","name","value","createList","response","CreateList","list_name","createCard","CreateCard","card_id","card_name","card_description","createNewButtonDiv","bind","status","object","getCardListID","cardObject","getCardName","getCardDescription","btnGroup","deleteCard","index","indexOf","DeleteCard","then","splice","DeleteList"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {Redirect} from \"react-router-dom\";\nimport UserService from \"../services/user.service\";\nimport Card from \"react-bootstrap/Card\";\nimport styles from \"./tables.module.css\";\nimport Button from \"react-bootstrap/Button\";\nimport ApiService from \"../services/api.service\";\nimport {ListModel} from \"../models/list.model\";\nimport {CardModel} from \"../models/card.model\";\nimport Form from \"react-bootstrap/Form\";\n\nexport default class TablesComponent extends React.Component {\n\n    state = {\n        redirect: false,\n        redirectUrl: '',\n        refresh: false,\n        creationView: false,\n        newListName: '',\n        objectToCreate: '',\n        newCardName: '',\n        description: '',\n        list_id: 0\n    }\n\n    lists: ListModel[] = [];\n    cards: CardModel[] = [];\n\n    private refresh(): void {\n        this.setState({refresh: false});\n\n        this.setState({refresh: true});\n    }\n\n    handleBackToBoards() {\n        this.setState({\n            redirect: true,\n            redirectUrl: 'tables'\n        })\n    }\n\n    async componentDidMount() {\n        this.lists = await ApiService.GetLists(+window.location.pathname.split('/')[2]);\n        const buffer = [];\n        for (const list of this.lists) {\n            let cards = await ApiService.GetCards(list.getListID());\n            for (const card of cards) {\n                buffer.push(card);\n            }\n        }\n        this.cards = buffer;\n        this.refresh();\n    }\n\n    private createLists() {\n        let lists = [];\n        if (this.state.refresh) {\n            let view: any[] = [];\n            this.lists.forEach(list => {\n                view.push(<Card className={styles.card}>\n                    <Card.Body>\n                        <Card.Title className={styles.listTitle}>\n                            {list.getListName()}\n                            <Button className={styles.cardButton} onClick={() => {\n                                this.deleteList(list);\n                            }} variant={\"danger\"}>Delete</Button>\n                        </Card.Title>\n                        {this.createCards(list.getListID())}\n                        <button onClick={() => {this.toggleCreationView(true, 'card', list.getListID())}}>Create new card</button>\n                    </Card.Body>\n                </Card>)\n            });\n            lists.push(view);\n        }\n        return lists;\n    }\n\n    render = () => {\n        UserService.subject.subscribe(() => {\n            this.setState({\n                redirect: true,\n                redirectUrl: '/login'\n            })\n        });\n        return <>\n            {this.renderRedirect()}\n            <button onClick={() => this.handleBackToBoards()}>Back to boards</button>\n            <button onClick={() => this.toggleCreationView(true, 'list', -1)}>New list</button>\n            <div className={styles.container}>\n                <div className={styles.creationForm}>\n                    {this.createListCreationView()}\n                </div>\n                <div className={styles.tables}>\n                    {this.createLists()}\n                </div>\n            </div>\n        </>;\n    }\n\n    handleChange(event: React.ChangeEvent<HTMLInputElement>) {\n        this.setState({\n            [event.target.name]: event.target.value\n        })\n    }\n\n    private async createList(name: string) {\n        const response = await ApiService.CreateList(name, +window.location.pathname.split('/')[2]);\n        const list = new ListModel(response.list_id, response.list_name);\n        this.lists.push(list);\n        this.refresh();\n    }\n\n    private async createCard(name: string, description: string, list_id: number) {\n        const response = await ApiService.CreateCard(name, description, list_id);\n        const card = new CardModel(response.card_id, response.list_id, response.card_name, response.card_description);\n        this.cards.push(card);\n        this.refresh();\n    }\n\n    private createListCreationView() {\n        if (this.state.creationView && this.state.objectToCreate === 'list') {\n            return (<>\n                    <div className={styles.createNewButtonDiv}>\n                        <Form.Group>\n                            <Form.Control name={'newListName'} value={this.state.newListName}\n                                          onChange={this.handleChange.bind(this)} type=\"text\"\n                                          placeholder=\"New list name\"/>\n                        </Form.Group>\n                    </div>\n                    <div className={styles.createNewButtonDiv}>\n                        <Button onClick={() => this.createList(this.state.newListName)}\n                                variant={\"success\"}>Create</Button>\n                        <Button onClick={() => this.toggleCreationView(false, '', -1)} variant={\"danger\"}>Hide</Button>\n                    </div>\n                </>\n            );\n        } else if (this.state.creationView && this.state.objectToCreate === 'card') {\n            return (<>\n                    <div className={styles.createNewButtonDiv}>\n                        <Form.Group>\n                            <Form.Control name={'newCardName'} value={this.state.newCardName}\n                                          onChange={this.handleChange.bind(this)} type=\"text\"\n                                          placeholder=\"New card name\"/>\n                            <Form.Control name={'description'} value={this.state.description}\n                                          onChange={this.handleChange.bind(this)} type=\"text\"\n                                          placeholder=\"Description\"/>\n                        </Form.Group>\n                    </div>\n                    <div className={styles.createNewButtonDiv}>\n                        <Button onClick={() => this.createCard(this.state.newCardName, this.state.description, this.state.list_id)}\n                                variant={\"success\"}>Create</Button>\n                        <Button onClick={() => this.toggleCreationView(false, '', -1)} variant={\"danger\"}>Hide</Button>\n                    </div>\n                </>\n            );\n        }\n    }\n\n    private toggleCreationView(status: boolean, object: string, list_id: number) {\n        this.setState({creationView: status, objectToCreate: object, list_id: list_id})\n    }\n\n    private renderRedirect() {\n        if (this.state.redirect) {\n            return <Redirect to={'/' + this.state.redirectUrl}/>\n        }\n    }\n\n    private createCards(list_id: number) {\n        let cards = [];\n        if (this.state.refresh) {\n            let view: any[] = [];\n            this.cards.forEach(card => {\n                if (card.getCardListID() === list_id) {\n                    view.push(<Card className={styles.cardObject}>\n                        <Card.Body>\n                            <Card.Title>\n                                {card.getCardName()}\n                            </Card.Title>\n                            <p>{card.getCardDescription()}</p>\n                            <div className={styles.btnGroup}>\n                                <Button className={styles.cardButton} onClick={() => {\n                                    this.deleteCard(card);\n                                }} variant={\"danger\"}>Delete</Button>\n                            </div>\n                        </Card.Body>\n                    </Card>)\n                }\n            });\n            cards.push(view);\n        }\n        return cards;\n    }\n\n    private deleteCard(card: CardModel) {\n        const index = this.cards.indexOf(card);\n        if (index !== -1) {\n            ApiService.DeleteCard(card).then(() => {\n                this.cards.splice(index, 1);\n                this.refresh();\n            });\n        }\n    }\n\n    private deleteList(list: ListModel) {\n        const index = this.lists.indexOf(list);\n        if (index !== -1) {\n            ApiService.DeleteList(list).then(() => {\n                this.lists.splice(index, 1);\n                this.refresh();\n            });\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"module"}